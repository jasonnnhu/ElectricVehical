# Results

## Number of EVs Registered Each Year (Up to 2023)
```{r}
suppressPackageStartupMessages(library(dplyr))
library(ggplot2)

ev_data <- read.csv('/Users/hujiasheng/Electric_Vehicle_Population_Data.csv')

ev_count_by_year <- ev_data %>% 
  group_by(Model.Year) %>%
  summarise(Count = n(), .groups= 'drop')

ggplot(ev_count_by_year, aes(x = Model.Year, y = Count)) +
  geom_line(na.rm = TRUE) +
  geom_point(na.rm = TRUE) +
  scale_x_continuous(limits = c(NA, 2023)) +
  theme_minimal() +
  ggtitle("Number of EVs Registered Each Year") +
  xlab("Year") +
  ylab("Number of EV Registrations")
```
This graph illustrates the annual registration count of electric vehicles (EVs) up to 2023, showcasing a clear upward trajectory in EV adoption. The increasing trend highlights the growing consumer shift towards sustainable transportation, likely spurred by technological advancements, environmental awareness, and policy incentives. Notable surges in certain years may correspond to key market or policy developments. This visualization serves as an indicator of the EV market's expanding footprint, reflecting the evolving landscape of automotive preferences and environmental considerations.

## Year-over-Year Growth Rate in EV Registrations (Up to 2023)
```{r}
ev_count_by_year <- ev_count_by_year %>%
  mutate(Growth = (Count / lag(Count) - 1) * 100)

ggplot(ev_count_by_year, aes(x = Model.Year, y = Growth)) +
  geom_line(color = "black", na.rm = TRUE) +
  geom_point(color = "black", na.rm = TRUE) +
  scale_x_continuous(limits = c(NA, 2023)) +
  theme_minimal() +
  ggtitle("Year-over-Year Growth Rate in EV Registrations") +
  xlab("Year") +
  ylab("Growth Rate (%)")
```
The graph depicting the year-over-year growth rate in EV registrations presents a dynamic perspective of the market's momentum. Fluctuations in growth rate, marked by peaks and troughs, signify periods of rapid expansion or slowdowns in EV adoption. These variations are indicative of market responses to external stimuli such as new model launches, changes in consumer preferences, or policy shifts. The graph offers insights into the market's responsiveness and periods of heightened interest in EVs, providing a nuanced understanding of the factors driving the EV market's evolution.

## Comparative Analysis of EV Adoption by Type (PHEV vs BEV)
```{r}
library(ggplot2)
library(dplyr)

filtered_ev_data <- ev_data %>%
  filter(Electric.Vehicle.Type %in% c("Plug-in Hybrid Electric Vehicle (PHEV)", "Battery Electric Vehicle (BEV)"))

ev_type_by_year <- filtered_ev_data %>%
  count(Model.Year, Electric.Vehicle.Type) %>%
  filter(Model.Year >= 2005)

ggplot(ev_type_by_year, aes(x = Model.Year, y = n, fill = Electric.Vehicle.Type)) +
  geom_bar(stat = "identity", position = "stack") +
  scale_x_continuous(limits = c(2005, 2025)) +
  theme_minimal() +
  labs(title = "Comparative Analysis of EV Adoption by Type (PHEV vs BEV)",
       x = "Year",
       y = "Number of Registrations",
       fill = "Electric Vehicle Type")
``` 
The graph provides a comparative analysis of adoption rates between Plug-in Hybrid Electric Vehicles (PHEVs) and Battery Electric Vehicles (BEVs). It reveals distinct trends in consumer preferences and technological advancements over the years. The stacked bar chart format clearly illustrates the proportionate dominance of each EV type per year, showcasing the shifting market dynamics. Key observations include the fluctuating popularity between PHEVs and BEVs, potentially influenced by evolving technology, policy changes, and market availability. This visualization serves as a valuable tool for understanding the trajectory of electric vehicle adoption, highlighting the nuanced preferences within the EV market.

## Spatial Distribution of EVs in States
```{r}
library(sf)
library(maps)

state_map <- map_data("state")

ev_data <- ev_data %>%
  mutate(
    Longitude = as.numeric(sub(".*\\(([^ ]+).*", "\\1", `Vehicle.Location`)),
    Latitude = as.numeric(sub(".* ([^ ]+)\\).*", "\\1", `Vehicle.Location`))
  ) %>%
  filter(!is.na(Longitude) & !is.na(Latitude))

coordinates <- st_as_sf(ev_data, coords = c("Longitude", "Latitude"), crs = 4326)

ggplot() +
  geom_polygon(data = state_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_sf(data = coordinates, color = "skyblue", size = 1, alpha = 0.5) +
  theme_minimal() +
  labs(title = "Spatial Distribution of EVs in Washington State",
       x = "Longitude",
       y = "Latitude")
```
The visualization maps the current registration of Battery Electric Vehicles (BEVs) and Plug-in Hybrid Electric Vehicles (PHEVs) in Washington State as recorded by the Department of Licensing (DOL). The higher density of points in the western part of the state likely reflects the greater population and infrastructure in urban areas such as Seattle, indicating a correlation between EV adoption and urbanization. The presence of EVs across more remote regions highlights a statewide commitment to sustainable transportation, despite varying levels of charging infrastructure and urban density. This spread underscores the importance of EVs in Washington's push for greener mobility solutions.

## Spatial Distribution of EVs in Washington State
```{r}
washington_map <- map_data("state", region = "washington")

ev_data_WA <- ev_data %>%
  mutate(
    Longitude = as.numeric(sub(".*\\(([^ ]+).*", "\\1", `Vehicle.Location`)),
    Latitude = as.numeric(sub(".* ([^ ]+)\\).*", "\\1", `Vehicle.Location`))
  ) %>%
  filter(!is.na(Longitude) & !is.na(Latitude)) %>%
  filter(between(Longitude, -124.848974, -116.916031) & 
         between(Latitude, 45.543541, 49.002494))

coordinates <- st_as_sf(ev_data_WA, coords = c("Longitude", "Latitude"), crs = 4326)

ggplot() +
  geom_polygon(data = washington_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_sf(data = coordinates, color = "skyblue", size = 1, alpha = 0.5) +
  theme_minimal() +
  labs(title = "Spatial Distribution of EVs in Washington State",
       x = "Longitude",
       y = "Latitude")

# Calculating the density of points to create a heatmap
ev_data_WA <- ev_data_WA %>%
  ggplot(aes(x = Longitude, y = Latitude)) +
  stat_density2d(aes(fill = after_stat(level)), geom = "polygon", color = "darkblue", alpha = 0.3) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  geom_polygon(data = washington_map, aes(x = long, y = lat, group = group), fill = NA, color = "black") +
  coord_fixed(1.3) +
  labs(title = "Heatmap of EVs in Washington State",
       x = "Longitude",
       y = "Latitude") +
  theme_minimal()

print(ev_data_WA)
```
The map showcases the geographical spread of electric vehicles (EVs) across Washington State, with a notable concentration in the metropolitan area around Puget Sound, including Seattle. This distribution pattern aligns with urban population densities and the availability of EV infrastructure such as charging stations. The scatter of EVs beyond these hubs into more rural areas indicates a broader adoption, possibly encouraged by state policies and incentives. The map highlights key areas for potential infrastructure development and offers a visual representation of EV penetration, which is crucial for planning future expansions of green transportation initiatives in Washington.
